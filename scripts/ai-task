#!/usr/bin/env bash
set -euo pipefail
cd "$(git rev-parse --show-toplevel)"

num="${1:?Usage: ai-task <number>}"
task=$(sed -n "${num}s/^[[:space:]]*[0-9][[:space:]]*)[[:space:]]*\"\(.*\)\".*/\1/p" RepoAI/tasks.md)

[ -z "$task" ] && { echo "Task $num not found in RepoAI/tasks.md"; exit 1; }

aider --yes-always --no-suggest-shell-commands --message "$task"

